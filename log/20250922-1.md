# Spring Boot 백엔드 환경 및 툴 설정

## 1. IntelliJ & Gradle

### Gradle이란?

* **빌드 자동화 툴**
  → 프로젝트 의존성 관리 + 빌드/테스트/배포 자동화
* Spring Boot에서는 Maven 대신 \*\*Gradle(Groovy DSL)\*\*을 주로 선택
* `build.gradle` 파일에서 의존성, 플러그인, 태스크 등을 정의

### build.gradle 구성

1. **plugins** : 사용 플러그인 정의 (`java`, `spring-boot`, `lombok` 등)
2. **repositories** : 외부 라이브러리를 가져올 저장소 지정 (`mavenCentral`)
3. **dependencies** : 프로젝트 의존성 정의
4. **tasks** : 빌드/테스트/배포와 같은 작업 정의

---

## 2. Spring Boot 프로젝트 생성

[Spring Initializr](https://start.spring.io) 이용

* **Dependencies**

  * Spring Web
  * Spring Boot DevTools
  * Lombok
  * Spring Data JPA

### 기본 구조

```java
@SpringBootApplication
public class CardatabaseApplication {
	public static void main(String[] args) {
		SpringApplication.run(CardatabaseApplication.class, args);
	}
}
```

`@SpringBootApplication` = 세 가지 애너테이션 조합

1. `@EnableAutoConfiguration` → 의존성 기반 자동 설정
2. `@ComponentScan` → 패키지 내 컴포넌트 검색
3. `@Configuration` → Bean 정의

---

## 3. Spring Boot DevTools & Logging

* **DevTools** : 코드 수정 시 자동 재시작
* **로깅** : Logback + SLF4J 기본 제공

```java
@SpringBootApplication
public class CardatabaseApplication {
	private static final Logger logger = LoggerFactory.getLogger(CardatabaseApplication.class);
	public static void main(String[] args) {
		SpringApplication.run(CardatabaseApplication.class, args);
		logger.info("Application Started !");
	}
}
```

### 로그 레벨

* TRACE / DEBUG / INFO / WARN / ERROR / FATAL / OFF
* `application.properties`에서 조정 가능

```properties
logging.level.root=DEBUG
```

---

## 4. 의존성 주입 (Dependency Injection)

### 정의

* 객체 간 의존성을 **외부에서 주입**하는 방식
* 코드 결합도를 낮추고 테스트 용이

### 의존성 주입 유형

1. **생성자 주입 (권장)**

   ```java
   public class Car {
       private final CarRepository carRepository;
       @Autowired
       public Car(CarRepository carRepository) {
           this.carRepository = carRepository;
       }
   }
   ```
2. **세터 주입 (선택적 의존성에 적합)**

   ```java
   @Service
   public class AppUserService {
       private AppUserRepository userRepository;
       @Autowired
       public void setAppUserRepository(AppUserRepository userRepository) {
           this.userRepository = userRepository;
       }
   }
   ```
3. **필드 주입 (간단하지만 권장 X)**

   ```java
   @Service
   public class CarController {
       @Autowired
       private CarDatabaseService carDatabaseService;
   }
   ```

---

## 5. JPA와 Entity

### ORM / JPA / Hibernate

* **ORM** : 객체 ↔ 관계형 DB 매핑
* **JPA** : Java ORM 표준 스펙
* **Hibernate** : JPA의 대표 구현체 (Spring Boot 기본 내장)

### Entity 예시

```java
@Entity
public class Car {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String brand, model, color, registrationNumber;
    private int modelYear, price;
}
```

* `@Id` : Primary Key 지정
* `@GeneratedValue` : PK 자동 생성
* `@Column` : 컬럼명, 길이, null 여부 등 설정 가능

---

## 6. H2 인메모리 DB 설정

### build.gradle

```gradle
dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
	runtimeOnly 'com.h2database:h2'
}
```

### application.properties

```properties
spring.datasource.url=jdbc:h2:mem:testdb
spring.jpa.show-sql=true
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
```

→ 실행 후 `http://localhost:8080/h2-console` 접속 가능

---

## 7. Repository와 CRUD

### CarRepository

```java
public interface CarRepository extends CrudRepository<Car, Long> {
}
```

* CrudRepository 기본 메서드

  * `save()`, `findAll()`, `findById()`, `delete()` 등

### CommandLineRunner로 더미 데이터 삽입

```java
@SpringBootApplication
public class CardatabaseApplication implements CommandLineRunner {
	private final CarRepository repository;

	public CardatabaseApplication(CarRepository repository) {
		this.repository = repository;
	}

	@Override
	public void run(String... args) {
		repository.save(new Car("Kia", "K5", "White", "11가1234", 2024, 3000));
	}
}
```

---

## 8. Lombok 적용

### build.gradle

```gradle
implementation 'org.projectlombok:lombok:1.18.42'
annotationProcessor 'org.projectlombok:lombok:1.18.42'
```

### Car.java

```java
@Entity
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Car {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String brand, model, color, registrationNumber;
    private int modelYear, price;
}
```

→ `@Data` = `@Getter` + `@Setter` + `@ToString` + `@EqualsAndHashCode`

---

## 9. Repository Query Methods

Spring Data JPA는 메서드 이름만으로 자동 쿼리 생성

```java
public interface CarRepository extends JpaRepository<Car, Long> {
    List<Car> findByBrand(String brand);
    List<Car> findByColor(String color);
    List<Car> findByModelYear(int modelYear);
    List<Car> findByBrandAndModel(String brand, String model);
    List<Car> findByBrandOrColor(String brand, String color);
    List<Car> findByBrandOrderByModelYearAsc(String brand);
}
```

* `findByBrand("Kia")`
* `findByColor("White")`
* `findByModelYear(2024)`

### @Query 직접 사용

```java
@Query("select c from Car c where c.brand like %?1")
List<Car> findByBrandEndsWith(String brand);

@Query("select c from Car c where c.brand like ?1%")
List<Car> findByBrandStartsWith(String brand);
```

---

## 10. Owner 테이블 (1\:N 관계)

### Owner.java

```java
@Entity
@Getter
@Setter
@NoArgsConstructor
@RequiredArgsConstructor
public class Owner {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long ownerId;

    @NonNull
    private String firstName;
    @NonNull
    private String lastName;

    @OneToMany(cascade = CascadeType.ALL, mappedBy = "owner")
    private List<Car> cars;
}
```

### Car.java (수정)

```java
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "owner")
private Owner owner;
```

### OwnerRepository.java

```java
public interface OwnerRepository extends JpaRepository<Owner, Long> {
}
```

---

# 정리

* **Gradle** : 프로젝트 의존성 관리 & 빌드 자동화
* **Spring Boot 기본 구조** : `@SpringBootApplication`
* **DI(의존성 주입)** : 생성자 주입이 권장
* **JPA/Hibernate** : Entity ↔ DB 테이블 매핑
* **H2 인메모리 DB** : 빠른 테스트용 DB
* **Repository** : CRUD & 쿼리 메서드 지원
* **Entity 관계** : Car ↔ Owner (1\:N)

---

👉 여기까지가 **Spring Boot 백엔드 기본기 + DB(JPA) 설정 + Repository 활용**입니다.
다음 단계는 \*\*REST API + Spring Data REST + Swagger(OpenAPI3)\*\*로 확장할 수 있겠네요.

---

혹시 이 정리본을 블로그에 올리실 때, 제가 목차를 **"환경 설정 → JPA → Repository → 관계 설정"** 순서로 배치했는데, 원하시면 \*\*"DI 먼저 → DB 설정 나중"\*\*으로 순서를 바꿔드릴까요?
